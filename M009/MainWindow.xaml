<Window x:Class="M009.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:M009"
        Title="MainWindow" Height="450" Width="800"
		WindowStartupLocation="CenterScreen" Topmost="True"
		DataContext="{Binding RelativeSource={RelativeSource Self}}">
	<Window.Resources>
		<!--Validierungsregeln konfigurierbar machen mittels Properties innerhalb der Rule Klasse(n)-->
		<local:LengthValidation x:Key="LengthV" Min="5" Max="20"/>

		<!--ValidatesOnTargetUpdated: Führt auch Validierung durch, wenn der Wert ursprünglich aus dem Backend kommt-->
		<local:LetterValidation x:Key="LetterV" ValidatesOnTargetUpdated="True"/>
		
		<!--ErrorTemplate-->
		<!--Darstellung des Fehlern anpassen-->
		<!--Wird u.a. dafür verwendet, um die Fehlernachricht anzuzeigen-->
		<ControlTemplate x:Key="ErrorTemp">
			<StackPanel>
				<Border BorderBrush="Red" BorderThickness="2">
					<!--AdornedElementPlaceholder: Element, welches gerade validiert wird-->
					<AdornedElementPlaceholder Name="AEP"/>
				</Border>
				<Popup IsOpen="{Binding ElementName=AEP, Path=AdornedElement.IsMouseOver, Mode=OneWay}"
					   Placement="MousePoint">
					<TextBlock Text="{Binding ElementName=AEP, Path=AdornedElement.(Validation.Errors)[0].ErrorContent}"
							   FontSize="20" Background="White" Foreground="Red"/>
				</Popup>
			</StackPanel>
		</ControlTemplate>
	</Window.Resources>
    <StackPanel Margin="10">
		<!--Validierung-->
		<!--User davon abhalten, falsche Eingaben zu machen-->
		
		<!--3 Optionen: -->
		<!--ValidationRules-->
		<!--ValidateOnException-->
		<!--ValidateOnDataError-->
		
		<!--ValidationRules-->
		<!--Beim Binding wird die Eingabe geprüft; das Binding wird abgebrochen, wenn der Wert invalide ist-->
		<TextBox>
			<TextBox.Text>
				<Binding Path="Vorname">
					<Binding.ValidationRules>
						<local:LengthValidation/>
						<local:LetterValidation/>
					</Binding.ValidationRules>
				</Binding>
			</TextBox.Text>
		</TextBox>
		<Button Content="Hallo" Click="Button_Click"/>
		
		<!--Validierung in der Kurzform-->
		<!--Mit eigener MarkupExtension-->
		<TextBox Text="{local:ValidationBinding Binding={Binding Vorname}, Rule1={StaticResource LengthV}, Rule2={StaticResource LetterV}}"
				 Validation.ErrorTemplate="{StaticResource ErrorTemp}"/>
		
		<!--ValidateOnException-->
		<!--Validiert, wenn im Backend eine Exception geworfen wird-->
		<TextBox Text="{Binding Nachname, ValidatesOnExceptions=True}"
				 Validation.ErrorTemplate="{StaticResource ErrorTemp}"/>
		
		<!--ValidateOnDataError-->
		<!--Verwendet das IDataErrorInfo Interface-->
		<!--Verwaltet die gesamte Validierungslogik an einem Ort-->
		<TextBox Text="{Binding ZweiterVorname, ValidatesOnDataErrors=True}"
				 Validation.ErrorTemplate="{StaticResource ErrorTemp}"/>
	</StackPanel>
</Window>
